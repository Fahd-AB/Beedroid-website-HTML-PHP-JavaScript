<!DOCTYPE html>

 

<html>

<head>

	 

 

	 
	<link rel="stylesheet" href="css/graph.css">
<meta name="robots" content="noindex,follow" />
</head>

<body>

<!-- Graph HTML -->
 
<div id="graph-wrapper">
	<div class="graph-info">
		<a href="javascript:void(0)" class="visitors">Visiteurs</a>
		<a href="javascript:void(0)" class="returning">Clients</a>

		<a href="#" id="bars"><span></span></a>
		<a href="#" id="lines" class="active"><span></span></a>
	</div>

	<div class="graph-container">
		<div id="graph-lines"></div>
		<div id="graph-bars"></div>
	</div>
	<br>
 <h4>Statistique sur les visiteurs</h4>
 
<!-- end Graph HTML -->
</div>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script src="js/jquery.flot.min.js"></script>
<script>
 
var visitor=[];
var client=[];
 var i=0;
 while(i<25)
 {
 visitor[i]=0;
 client[i]=0;
 i++;
 } 
 
function nbVisitor(json)
	{
	 
	 var t=json.length;
	 var i=0;
	 
	 while(i<t)
	 {
	 var str=json[i]+"";
      //alert("json :"+json[i]);
	 if(str.indexOf("00")!=-1)
	 {
	
	 visitor[0]=visitor[0]+1;
	 
	 }
	 
	 if(str.indexOf("01")!=-1)
	 {
	 visitor[1]=visitor[1]+1;
	 
	 }
	 
	 
	 
	 if(str.indexOf("02")!=-1)
	 {
	 visitor[2]=visitor[2]+1;
	 }
	 
	 if(str.indexOf("03")!=-1)
	 {
	 visitor[3]=visitor[3]+1;
	 }
	 
	 if(str.indexOf("04")!=-1)
	 {
	 visitor[4]=visitor[4]+1;
	 }
	 
	 
	 if(str.indexOf("05")!=-1)
	 {
	 visitor[5]=visitor[5]+1;
	 }
	 
	 
	 if(str.indexOf("06")!=-1)
	 {
	 visitor[6]=visitor[6]+1;
	 }
	 
	 
	 if(str.indexOf("07")!=-1)
	 {
	 visitor[7]=visitor[7]+1;
	 }
	 
	 if(str.indexOf("08")!=-1)
	 {
	 visitor[8]=visitor[8]+1;
	 }
	 
	 
	 if(str.indexOf("09")!=-1)
	 {
	 visitor[9]=visitor[9]+1;
	 }
	 
	 
	 if(str.indexOf("10")!=-1)
	 {
	 visitor[10]=visitor[10]+1;
	 }
	 
	 
	 if(str.indexOf("11")!=-1)
	 {
	 visitor[11]=visitor[11]+1;
	 }
	 
	 
	 if(str.indexOf("12")!=-1)
	 {
	 visitor[12]=visitor[12]+1;
	 }
	 
	 if(str.indexOf("13")!=-1)
	 {
	 visitor[13]=visitor[13]+1;
	 }
	 
	 
	 if(str.indexOf("14")!=-1)
	 {
	 visitor[14]=visitor[14]+1;
	 }
	 
	 
	 if(str.indexOf("15")!=-1)
	 {
	 visitor[15]=visitor[15]+1;
	 }
	 
	 
	 if(str.indexOf("16")!=-1)
	 {
	 visitor[16]=visitor[16]+1;
	 }
	 
	 
	 if(str.indexOf("17")!=-1)
	 {
	 visitor[17]=visitor[17]+1;
	 }
	 
	 
	 if(str.indexOf("18")!=-1)
	 {
	 visitor[18]=visitor[18]+1;
	 }
	 
	 
	 if(str.indexOf("19")!=-1)
	 {
	 visitor[19]=visitor[19]+1;
	 }
	 
	 
	 if(str.indexOf("20")!=-1)
	 {
	 visitor[20]=visitor[20]+1;
	 }
	 
	 
	 if(str.indexOf("21")!=-1)
	 {
	 visitor[21]=visitor[21]+1;
	 }
	 
	 
	 if(str.indexOf("22")!=-1)
	 {
	 visitor[22]=visitor[22]+1;
	 }
	 
	 if(str.indexOf("23")!=-1)
	 {
	 visitor[23]=visitor[23]+1;
	 }
	 
	 
	 
	 i++;
	 }
	
	
	
 
	
	}
	
/********************************nb client*****************************************************/	
	function nbclient(json)
	{
	 
	 var t=json.length;
	 var i=0;
	 
	 while(i<t)
	 {
	 var str=json[i]+"";
      //alert("json :"+json[i]);
	 if(str.indexOf("00")!=-1)
	 {
	
	 client[0]=client[0]+1;
	 
	 }
	 
	 if(str.indexOf("01")!=-1)
	 {
	 client[1]=client[1]+1;
	 
	 }
	 
	 
	 
	 if(str.indexOf("02")!=-1)
	 {
	 client[2]=client[2]+1;
	 }
	 
	 if(str.indexOf("03")!=-1)
	 {
	 client[3]=client[3]+1;
	 }
	 
	 if(str.indexOf("04")!=-1)
	 {
	 client[4]=client[4]+1;
	 }
	 
	 
	 if(str.indexOf("05")!=-1)
	 {
	 client[5]=client[5]+1;
	 }
	 
	 
	 if(str.indexOf("06")!=-1)
	 {
	 client[6]=client[6]+1;
	 }
	 
	 
	 if(str.indexOf("07")!=-1)
	 {
	 client[7]=client[7]+1;
	 }
	 
	 if(str.indexOf("08")!=-1)
	 {
	 client[8]=client[8]+1;
	 }
	 
	 
	 if(str.indexOf("09")!=-1)
	 {
	 client[9]=client[9]+1;
	 }
	 
	 
	 if(str.indexOf("10")!=-1)
	 {
	 client[10]=client[10]+1;
	 }
	 
	 
	 if(str.indexOf("11")!=-1)
	 {
	 client[11]=client[11]+1;
	 }
	 
	 
	 if(str.indexOf("12")!=-1)
	 {
	 client[12]=client[12]+1;
	 }
	 
	 if(str.indexOf("13")!=-1)
	 {
	 client[13]=client[13]+1;
	 }
	 
	 
	 if(str.indexOf("14")!=-1)
	 {
	 client[14]=client[14]+1;
	 }
	 
	 
	 if(str.indexOf("15")!=-1)
	 {
	 client[15]=client[15]+1;
	 }
	 
	 
	 if(str.indexOf("16")!=-1)
	 {
	 client[16]=client[16]+1;
	 }
	 
	 
	 if(str.indexOf("17")!=-1)
	 {
	 client[17]=client[17]+1;
	 }
	 
	 
	 if(str.indexOf("18")!=-1)
	 {
	 client[18]=client[18]+1;
	 }
	 
	 
	 if(str.indexOf("19")!=-1)
	 {
	 client[19]=client[19]+1;
	 }
	 
	 
	 if(str.indexOf("20")!=-1)
	 {
	 client[20]=client[20]+1;
	 }
	 
	 
	 if(str.indexOf("21")!=-1)
	 {
	 client[21]=client[21]+1;
	 }
	 
	 
	 if(str.indexOf("22")!=-1)
	 {
	 client[22]=client[22]+1;
	 }
	 
	 if(str.indexOf("23")!=-1)
	 {
	 client[23]=client[23]+1;
	 }
	 
	 
	 
	 i++;
	 }
	
	
	
 
	
	}
	
	
	
	
	
	
	
	
	
	var main1='{"visite":"nb"}';
$.getJSON("nbvisite.php",{visitor:main1},nbVisitor);

var main1='{"visite":"nbclient"}';
$.getJSON("nbvisite.php",{visitor:main1},nbclient);
		
		
var test=false;
setInterval(function(){ 
var d = new Date();
var n = d.getHours();

if(n==0 && test==false)
{ 
var main1='{"visite":"deleteclient"}';
$.getJSON("nbvisite.php",{visitor:main1});
test=true;
}
 }, 3600000);		

 
var test1=false;
setInterval(function(){ 
var d = new Date();
var n = d.getHours();

if(n==0 && test1==false)
{ 
var main1='{"visite":"deletevisitor"}';
$.getJSON("nbvisite.php",{visitor:main1});
test1=true;
}
 }, 3600000);		
 
 







setTimeout(function(){
 var i=0;
 while(i<24)
 {
 //alert("visitor : "+visitor[i]);
 i++;
 } 

 
$(document).ready(function () {

	// Graph Data ##############################################
	var graphData = [{
			// Visits
			data: [ [00,visitor[0]], [01,visitor[1]], [02,visitor[2]], [03,visitor[3]], [04,visitor[4]], [05,visitor[5]], [06,visitor[6]], [07,visitor[7]], [08,visitor[8]], [09,visitor[9]],[10,visitor[10]],[11,visitor[11]],[12,visitor[12]],[13,visitor[13]],[14,visitor[14]],[15,visitor[15]],[16,visitor[16]],[17,visitor[17]],[18,visitor[18]],[19,visitor[19]],[20,visitor[20]],[21,visitor[21]],[22,visitor[22]],[23,visitor[23]] ],
			color: '#71c73e'
		}, {
			// Returning Visits
			data: [ [00,client[0]], [01,client[1]], [02,client[2]], [03,client[3]], [04,client[4]], [05,client[5]], [06,client[6]], [07,client[7]], [08,client[8]], [09,client[9]],[10,client[10]],[11,client[11]],[12,client[12]],[13,client[13]],[14,client[14]],[15,client[15]],[16,client[16]],[17,client[17]],[18,client[18]],[19,client[19]],[20,client[20]],[21,client[21]],[22,client[22]],[23,client[23]] ],
			color: '#77b7c5',
			points: { radius: 4, fillColor: '#77b7c5' }
		}
	];

	// Lines Graph #############################################
	$.plot($('#graph-lines'), graphData, {
		series: {
			points: {
				show: true,
				radius: 5
			},
			lines: {
				show: true
			},
			shadowSize: 0
		},
		grid: {
			color: '#646464',
			borderColor: 'transparent',
			borderWidth: 20,
			hoverable: true
		},
		xaxis: {
			tickColor: 'transparent',
			tickDecimals: 2
		},
		yaxis: {
			tickSize: 1000
		}
	});

	// Bars Graph ##############################################
	$.plot($('#graph-bars'), graphData, {
		series: {
			bars: {
				show: true,
				barWidth: .9,
				align: 'center'
			},
			shadowSize: 0
		},
		grid: {
			color: '#646464',
			borderColor: 'transparent',
			borderWidth: 20,
			hoverable: true
		},
		xaxis: {
			tickColor: 'transparent',
			tickDecimals: 2
		},
		yaxis: {
			tickSize: 1000
		}
	});

	// Graph Toggle ############################################
	$('#graph-bars').hide();

	$('#lines').on('click', function (e) {
		$('#bars').removeClass('active');
		$('#graph-bars').fadeOut();
		$(this).addClass('active');
		$('#graph-lines').fadeIn();
		e.preventDefault();
	});

	$('#bars').on('click', function (e) {
		$('#lines').removeClass('active');
		$('#graph-lines').fadeOut();
		$(this).addClass('active');
		$('#graph-bars').fadeIn().removeClass('hidden');
		e.preventDefault();
	});

	// Tooltip #################################################
	function showTooltip(x, y, contents) {
		$('<div id="tooltip">' + contents + '</div>').css({
			top: y - 16,
			left: x + 20
		}).appendTo('body').fadeIn();
	}

	var previousPoint = null;

	$('#graph-lines, #graph-bars').bind('plothover', function (event, pos, item) {
		if (item) {
			if (previousPoint != item.dataIndex) {
				previousPoint = item.dataIndex;
				$('#tooltip').remove();
				var x = item.datapoint[0],
					y = item.datapoint[1];
					showTooltip(item.pageX, item.pageY, y + ' visitors at ' + x + '.00h');
			}
		} else {
			$('#tooltip').remove();
			previousPoint = null;
		}
	});

});
},1000);
</script>

</body>

</html>